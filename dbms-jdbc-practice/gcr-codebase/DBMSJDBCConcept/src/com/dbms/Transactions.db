-- create database bank containing all types of data
CREATE DATABASE bank_db;

-- switching to the db 
USE bank_db;

-- accounts table storing details of all accounts
+---------+---------------+------+-----+---------+----------------+
| Field   | Type          | Null | Key | Default | Extra          |
+---------+---------------+------+-----+---------+----------------+
| id      | int           | NO   | PRI | NULL    | auto_increment |
| name    | varchar(100)  | YES  |     | NULL    |                |
| balance | decimal(15,2) | YES  |     | NULL    |                |
+---------+---------------+------+-----+---------+----------------+
CREATE TABLE accounts (id INTEGER PRIMARY KEY AUTO_INCREMENT, name VARCHAR (100), balance DECIMAL (15, 2));


-- transaction table storing transaction history
+-------------+---------------+------+-----+-------------------+-------------------+
| Field       | Type          | Null | Key | Default           | Extra             |
+-------------+---------------+------+-----+-------------------+-------------------+
| id          | int           | NO   | PRI | NULL              | auto_increment    |
| sender_id   | int           | YES  | MUL | NULL              |                   |
| receiver_id | int           | YES  | MUL | NULL              |                   |
| amount      | decimal(15,2) | NO   |     | NULL              |                   |
| created_at  | timestamp     | NO   |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED |
+-------------+---------------+------+-----+-------------------+-------------------+
CREATE TABLE transaction_history (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    sender_id INTEGER REFERENCES accounts(id),
    receiver_id INTEGER REFERENCES accounts(id),
    amount DECIMAL (15, 2) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL
);

-- add acounts
+----+----------+---------+
| id | name     | balance |
+----+----------+---------+
|  1 | Aneek    | 5000.00 |
|  2 | Abhishek | 2000.00 |
+----+----------+---------+
INSERT INTO accounts (name, balance) VALUES ('Aneek' , 5000), ('Abhishek', 2000); 

-- Start a transfer (Transaction)
START TRANSACTION;

-- Deduct money from Sender
UPDATE
    accounts
SET
    balance = balance - 500
WHERE
    id = 1;

-- Add money to Receiver
UPDATE
    accounts
SET
    balance = balance + 500
WHERE
    id = 2;

-- Log the transaction history
INSERT INTO
    transaction_history (sender_id, receiver_id, amount)
VALUES
    (1, 2, 500);

-- Finalize
COMMIT;

-- Check balance
+----+----------+---------+
| id | name     | balance |
+----+----------+---------+
|  1 | Aneek    | 4500.00 |
|  2 | Abhishek | 2500.00 |
+----+----------+---------+
SELECT * FROM accounts;

-- -- View Transactions
+----+-----------+-------------+--------+---------------------+
| id | sender_id | receiver_id | amount | created_at          |
+----+-----------+-------------+--------+---------------------+
|  1 |         1 |           2 | 500.00 | 2026-02-09 07:24:56 |
+----+-----------+-------------+--------+---------------------+
SELECT * FROM transaction_history;